import{K as _,r as t,m as O,j as e,L as F,S as L}from"./app-CV7uQCN8.js";import{A as $}from"./app-layout-DW-QwsIP.js";import"./navbar-B6tlJW2d.js";function q(){const{clases:m,inscripciones:b,flash:a,errors:r}=_().props,[d,y]=t.useState("formulario"),[u,v]=t.useState(""),[S,N]=t.useState([]),[h,l]=t.useState(null),[x,i]=t.useState((a==null?void 0:a.success)??null),[E,g]=t.useState(!1),[p,k]=t.useState(null),{data:o,setData:f,post:C,processing:j,clearErrors:w}=O({clase_id:""});t.useEffect(()=>{if(u){const s=m.filter(n=>n.nombre===u).sort((n,c)=>new Date(n.fecha).getTime()-new Date(c.fecha).getTime());N(s),f("clase_id",""),l(null),w()}else N([])},[u,m,w,f]),t.useEffect(()=>{a!=null&&a.success&&i(a.success)},[a]);const D=Array.from(new Set(m.map(s=>s.nombre))),I=s=>{s.preventDefault(),C(route("inscribirse.guardar"),{onError:n=>{l(n.general??null),i(null)},onSuccess:()=>{l(null),i("Inscripción realizada con éxito.")}})};return e.jsxs($,{children:[e.jsx(F,{title:"Inscripciones"}),e.jsxs("div",{className:"max-w-3xl mx-auto p-6 text-black",children:[(x||h||Object.keys(r).length>0)&&e.jsxs("div",{className:"mb-4 space-y-2",children:[x&&e.jsx("div",{className:"p-2 bg-green-100 border border-green-300 text-green-800 rounded",children:x}),h&&e.jsx("div",{className:"p-2 bg-red-100 border border-red-300 text-red-800 rounded",children:h}),Object.keys(r).map(s=>e.jsx("div",{className:"p-2 bg-red-100 border border-red-300 text-red-800 rounded",children:r[s]},s))]}),e.jsxs("div",{className:"flex border-b mb-6",children:[e.jsx("button",{className:`px-4 py-2 font-semibold ${d==="formulario"?"border-b-4 border-green-600 text-green-600":"text-gray-500 cursor-pointer"}`,onClick:()=>{y("formulario"),l(null),i(null),Object.keys(r).forEach(s=>delete r[s])},children:"Inscribirse"}),e.jsx("button",{className:`px-4 py-2 font-semibold ${d==="misClases"?"border-b-4 border-green-600 text-green-600":"text-gray-500 cursor-pointer"}`,onClick:()=>{y("misClases"),l(null),i(null),Object.keys(r).forEach(s=>delete r[s])},children:"Mis clases"})]}),d==="formulario"&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Inscribirse a una clase"}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Nombre de clase"}),e.jsxs("select",{value:u,onChange:s=>{v(s.target.value),l(null),i(null),Object.keys(r).forEach(n=>delete r[n])},className:"w-full border px-3 py-2 rounded",required:!0,children:[e.jsx("option",{value:"",children:"Selecciona una clase"}),D.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),S.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-1",children:"Día y hora"}),e.jsx("ul",{className:"space-y-2",children:S.map(s=>{const n=b.some(c=>c.clase_id===s.id&&new Date(c.fecha).toISOString()===new Date(s.fecha).toISOString());return e.jsx("li",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"clase_id",value:s.id,id:`clase-${s.id}`,onChange:()=>{f("clase_id",s.id.toString()),l(null),i(null),Object.keys(r).forEach(c=>delete r[c])},checked:o.clase_id===s.id.toString(),disabled:n,className:"peer hidden"}),e.jsx("label",{htmlFor:`clase-${s.id}`,className:"flex items-center gap-2 cursor-pointer select-none",children:e.jsx("span",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center transition ${o.clase_id===s.id.toString()?"border-[#41A510]":"border-gray-400"}`,children:e.jsx("span",{className:`w-2 h-2 rounded-full ${o.clase_id===s.id.toString()?"bg-[#41A510]":""}`})})}),new Date(s.fecha).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),", ",new Date(s.fecha).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})]})},s.id)})})]}),e.jsx("button",{type:"submit",disabled:j||!o.clase_id,className:`px-4 py-2 rounded text-white ${j||!o.clase_id?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 cursor-pointer"}`,children:j?"Enviando...":"Inscribirse"})]})]}),d==="misClases"&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Clases inscritas"}),b.length===0?e.jsx("p",{className:"text-gray-600",children:"Aún no estás inscrito en ninguna clase."}):e.jsx("ul",{className:"space-y-3",children:b.map((s,n)=>e.jsxs("li",{className:"border p-3 rounded bg-white flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Clase:"})," ",s.nombre]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," ",new Date(s.fecha).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),", ",new Date(s.fecha).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})]})]}),e.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded cursor-pointer",onClick:()=>{k(s),g(!0)},children:"Cancelar"})]},n))})]}),E&&p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-white/20",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["¿Estás seguro de que deseas cancelar la inscripción de"," ",e.jsx("span",{className:"text-green-700",children:p.nombre}),"?"]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 rounded border border-gray-400 text-gray-700 hover:bg-gray-100 cursor-pointer",children:"Cancelar"}),e.jsx("button",{onClick:()=>{L.delete(route("inscribirse.eliminar",p.id)),g(!1)},className:"px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700 cursor-pointer",children:"Confirmar"})]})]})})]})]})}export{q as default};
