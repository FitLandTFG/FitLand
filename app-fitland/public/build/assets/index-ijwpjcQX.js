import{r as i,K as w,S as p,j as e,L as S,$ as C}from"./app-CV7uQCN8.js";import{A}from"./app-layout-DW-QwsIP.js";import{X as I}from"./x-CewRyoLY.js";import{c as M}from"./createLucideIcon-CbpJX9Ck.js";import"./navbar-B6tlJW2d.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],E=M("Info",$);function D({productos:u,categorias:N,filtros:h,user:v}){const[c,b]=i.useState(h.buscar||""),[o,g]=i.useState(h.categoria||""),{url:y}=w(),j=new URLSearchParams(y.split("?")[1]||"").get("page")||1,f=(s,a)=>{p.get(route("tienda.index"),{buscar:s!==void 0?s:c,categoria:a!==void 0?a:o},{preserveState:!0})};i.useEffect(()=>{const s=setTimeout(()=>{p.get(route("tienda.index"),{buscar:c,categoria:o,page:j},{preserveState:!0})},300);return()=>clearTimeout(s)},[c,o,j]);const[t,l]=i.useState(null),[n,d]=i.useState(1),k=()=>{l(null),d(1)};return e.jsxs(A,{children:[e.jsx(S,{title:"Tienda"}),e.jsxs("div",{className:"flex flex-col md:flex-row max-w-7xl mx-auto p-4",children:[e.jsxs("aside",{className:"md:w-1/4 mb-4 md:mb-0",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Categorías"}),e.jsxs("ul",{children:[e.jsx("li",{className:`cursor-pointer mb-1 ${o?"":"font-bold"} hover:underline hover:decoration-[#41A510]`,onClick:()=>{g(""),f(c,"")},children:"Todas"}),N.map(s=>e.jsx("li",{className:`cursor-pointer mb-1 ${o===s?"font-bold":""} hover:underline hover:decoration-[#41A510]`,onClick:()=>{g(s),f(c,s)},children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]}),e.jsxs("main",{className:"md:w-3/4 md:pl-6",children:[e.jsxs("div",{className:"mb-4 relative",children:[e.jsx("input",{type:"text",value:c,onChange:s=>b(s.target.value),placeholder:"Buscar productos...",className:"w-full p-2 pr-10 border rounded"}),c&&e.jsx("button",{type:"button",onClick:()=>b(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-black",children:e.jsx(I,{size:18})})]}),u.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:u.data.map(s=>e.jsxs("div",{className:"border p-4 rounded flex flex-col items-center cursor-pointer",onClick:()=>l(s),children:[e.jsx("img",{src:s.imagen,alt:s.nombre,className:"w-full h-80 object-contain"}),e.jsx("h3",{className:"text-lg font-semibold text-center mt-2",children:s.nombre}),e.jsxs("div",{className:"text-gray-700 mt-2",children:[s.precio.toFixed(2),"€"]}),e.jsx("div",{className:"flex space-x-4 mt-2",children:e.jsx(E,{className:"text-white",size:20})})]},s.id))}),e.jsx("div",{className:"flex justify-center mt-6 space-x-2",children:u.links.map((s,a)=>{const r=s.label.replace(/&laquo;|&raquo;/g,"").replace("Previous","Anterior").replace("Next","Siguiente");return s.url?e.jsx(C,{href:s.url,className:`px-3 py-1 border rounded ${s.active?"bg-[#41A510] text-white border-[#41A510]":"bg-white text-[#41A510] border-[#41A510] hover:bg-[#41A510] hover:text-white"}`,children:r},a):e.jsx("span",{className:"px-3 py-1 border rounded text-gray-400",children:r},a)})})]}):e.jsx("p",{children:"No se han encontrado resultados con esa búsqueda."})]})]}),t&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm",onClick:k,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-5xl relative",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-black cursor-pointer",onClick:()=>l(null),children:"✕"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("img",{src:t.imagen,alt:t.nombre,className:"w-full md:w-1/2 h-[28rem] object-contain"}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3",children:t.nombre}),e.jsx("p",{className:"text-gray-700 mb-3",children:t.descripcion||"Sin descripción disponible."}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Stock disponible: ",t.stock??"N/D"]}),e.jsxs("p",{className:"text-2xl font-semibold mb-4",children:[t.precio.toFixed(2),"€"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(Math.max(1,n-1)),className:"px-3 py-1 bg-gray-300 rounded hover:bg-gray-400 cursor-pointer",children:"-"}),e.jsx("input",{type:"number",value:n,onChange:s=>{const a=parseInt(s.target.value);!isNaN(a)&&a>0&&a<=(t.stock??a)&&d(a)},className:"w-16 text-center border rounded py-1 no-arrows"}),e.jsx("button",{onClick:()=>d(s=>t.stock?Math.min(t.stock,s+1):s+1),className:"px-3 py-1 bg-gray-300 rounded hover:bg-gray-400 cursor-pointer",children:"+"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>{if(!v){p.visit("/login");return}const s=t.stock??0,a=localStorage.getItem("carrito"),r=a?JSON.parse(a):[],m=r.findIndex(x=>x.id===t.id);if(m!==-1){const x=r[m].cantidad+n;x>s?r[m].cantidad=s:r[m].cantidad=x}else r.push({id:t.id,nombre:t.nombre,precio:t.precio,imagen:t.imagen,cantidad:Math.min(n,s),stock:s});localStorage.setItem("carrito",JSON.stringify(r)),window.dispatchEvent(new Event("carritoActualizado")),l(null)},disabled:t.stock===0,className:`${t.stock===0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 cursor-pointer"} text-white px-4 py-2 rounded mt-2`,children:t.stock===0?"Sin stock":"Añadir al carrito"})})]})]})]})})]})}export{D as default};
