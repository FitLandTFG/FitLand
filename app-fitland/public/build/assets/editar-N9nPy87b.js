import{m as g,j as e}from"./app-CV7uQCN8.js";const y=p=>{var u;const{compra:c,usuarios:m,productos:x,flash:l}=p,{data:d,setData:t,put:h,processing:b,errors:r}=g({usuario_id:c.usuario_id,fecha_compra:c.fecha_compra,productos:c.detalles.map(a=>({id:a.producto_id,cantidad:a.cantidad}))}),j=a=>{a.preventDefault(),h(`/admin/compras/${c.id}`)},v=()=>{t("productos",[...d.productos,{id:"",cantidad:1}])},f=a=>{const s=[...d.productos];s.splice(a,1),t("productos",s)},n=(a,s,o)=>{const i=[...d.productos];s==="id"?i[a].id=o:s==="cantidad"&&(i[a].cantidad=parseInt(o)),t("productos",i)};return e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Editar Compra"}),(l==null?void 0:l.error)&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:l.error}),e.jsxs("form",{onSubmit:j,className:"space-y-4 max-w-xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Usuario"}),e.jsxs("select",{value:d.usuario_id,onChange:a=>t("usuario_id",a.target.value),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Seleccionar usuario"}),m.map(a=>e.jsx("option",{value:a.id,children:a.nombre_completo},a.id))]}),r.usuario_id&&e.jsx("p",{className:"text-red-600 text-sm",children:r.usuario_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Fecha de Compra"}),e.jsx("input",{type:"datetime-local",value:(u=d.fecha_compra)==null?void 0:u.slice(0,16),onChange:a=>t("fecha_compra",a.target.value),className:"w-full border rounded px-3 py-2"}),r.fecha_compra&&e.jsx("p",{className:"text-red-600 text-sm",children:r.fecha_compra})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 font-semibold",children:"Productos"}),d.productos.map((a,s)=>e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("select",{value:a.id,onChange:o=>n(s,"id",o.target.value),className:"flex-1 border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Seleccionar producto"}),x.map(o=>e.jsx("option",{value:o.id,children:o.nombre},o.id))]}),e.jsx("input",{type:"number",min:1,value:a.cantidad,onChange:o=>n(s,"cantidad",o.target.value),className:"w-24 border rounded px-3 py-2",placeholder:"Cantidad"}),e.jsx("button",{type:"button",onClick:()=>f(s),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"×"})]},s)),r.productos&&e.jsx("p",{className:"text-red-600 text-sm",children:r.productos}),e.jsx("button",{type:"button",onClick:v,className:"mt-2 text-sm text-blue-600 hover:underline",children:"+ Añadir otro producto"})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 disabled:opacity-50",children:"Actualizar compra"}),e.jsx("a",{href:"/admin/compras",className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Volver"})]})]})]})};export{y as default};
